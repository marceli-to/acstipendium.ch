<div 
  class="rounded-16 lg:rounded-32 lg:border-2 lg:border-white lg:px-12 lg:py-16"
  x-data="{
    sortFellows() {
      const items = Array.from(this.$el.querySelectorAll('[data-fellow]'));
      const sorted = items.sort((a, b) => {
        let valueA, valueB;

        switch(sortBy) {
          case 'name':
            valueA = a.dataset.name.toLowerCase();
            valueB = b.dataset.name.toLowerCase();
            return sortDirection === 'asc'
              ? valueA.localeCompare(valueB)
              : valueB.localeCompare(valueA);

          case 'scholarship':
            valueA = a.dataset.scholarship;
            valueB = b.dataset.scholarship;
            return sortDirection === 'asc'
              ? valueA.localeCompare(valueB)
              : valueB.localeCompare(valueA);

          case 'amount':
            valueA = parseInt(a.dataset.amount);
            valueB = parseInt(b.dataset.amount);
            return sortDirection === 'asc' ? valueA - valueB : valueB - valueA;

          case 'year':
          default:
            valueA = parseInt(a.dataset.year);
            valueB = parseInt(b.dataset.year);
            return sortDirection === 'asc' ? valueA - valueB : valueB - valueA;
        }
      });

      sorted.forEach((item, index) => {
        item.style.order = index;
      });
    }
  }"
  x-init="
    $watch('sortBy', () => sortFellows()); 
    $watch('sortDirection', () => sortFellows()); 
    sortFellows()">

  <header class="flex justify-between w-full items-center mb-4 lg:mb-8 text-primary text-md lg:text-lg">
    <span class="flex items-center leading-none bg-white px-16 py-8 lg:py-11 rounded-16 lg:rounded-32 w-[calc(100%_-_64px)] lg:w-[calc(39%_-_3px)] xl:w-[calc(41%_-_3px)] mr-4">
      {{ "Name" | trans }}
    </span>
    <span class="hidden lg:flex items-center leading-none bg-white px-16 py-8 lg:py-11 rounded-16 lg:rounded-32 lg:w-[calc(26%_-_3px)] mr-4">
      {{ "Stipendium" | trans }}
    </span>
    <span class="hidden lg:flex items-center leading-none bg-white px-16 py-8 lg:py-11 rounded-16 lg:rounded-32 lg:w-[calc(24%_-_3px)] mr-4">
      {{ "Förderbeitrag" | trans }}
    </span>
    <span class="flex items-center justify-end leading-none bg-white px-16 py-8 lg:py-11 rounded-16 lg:rounded-32 w-[64px] lg:w-[calc(11%_-_3px)] xl:w-[calc(9%_-_3px)]">
      {{ "Jahr" | trans }}
    </span>
  </header>
  
  {{ partial:accordion/wrapper class="flex flex-col gap-y-4 lg:gap-y-8" }}

    {{ collection:fellows }}

      {{ partial:accordion/item
         btnClass="!px-0"
         :index="index"
         :title="title"
         data-slug="{slug}"
         data-fellow="1"
         data-name="{name}"
         data-scholarship="{scholarship_type}"
         data-amount="{amount}"
         data-year="{year}" }}

          {{ slot:title }}
            <span class="flex justify-between w-full items-center">
              <span 
                class="flex items-center leading-none mr-4 px-16" 
                :class="open ? 'justify-center w-full' : 'w-[calc(100%_-_64px)] lg:w-[calc(39%_-_3px)] xl:w-[calc(41%_-_3px)]'">
                {{ title }}
              </span>
              <span 
                class="hidden lg:flex items-center leading-none lg:w-[calc(26%_-_3px)] mr-4 px-16" 
                x-show="!open">
                {{ if scholarship_type == 'main_scholarship' }}
                  {{ "Hauptstipendium" | trans }}
                {{ elseif scholarship_type == 'promote_scholarship' }}
                  {{ "Förderstipendium" | trans }}
                {{ /if }}
              </span>
              <span
                class="hidden lg:flex items-center leading-none lg:w-[calc(24%_-_3px)] mr-4 px-16"
                x-show="!open">
                {{ amount | format_number:0:".":"’" }}
              </span>
              <span 
                class="flex items-center justify-end leading-none w-[64px] lg:w-[calc(11%_-_3px)] xl:w-[calc(9%_-_3px)] px-16" 
                x-show="!open">
                {{ year }}
              </span>
            </span>
          {{ /slot:title }}

        <div class="lg:grid lg:grid-cols-9 lg:gap-x-16">

          {{ if portrait_image }}
            <div class="lg:col-span-3 mb-8 lg:mb-0">
              {{ partial:media/image
                :image="portrait_image"
                :sizes="['lg', 'xl', '2xl']"
                wrapperClass="rounded-14 lg:rounded-24 overflow-hidden"
                class="w-full h-full object-cover" }}
            </div>
          {{ /if }}

          <div class="lg:col-span-6">
            <div class="flex flex-col gap-y-8">
              {{ partial:fellows/components/scholarship }}
              {{ partial:fellows/components/download_links }}
              {{ partial:fellows/components/images }}
            </div>
          </div>

        </div>

      {{ /partial:accordion/item }}

    {{ /collection:fellows }}

  {{ /partial:accordion/wrapper }}

</div>
